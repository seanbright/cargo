<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The Cargo “compile” operation."><meta name="keywords" content="rust, rustlang, rust-lang, cargo_compile"><title>cargo::ops::cargo_compile - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script defer src="../../../main.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../cargo/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../cargo/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module cargo_compile</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../../cargo/index.html"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Module <a href="../../index.html">cargo</a>::<wbr><a href="../index.html">ops</a>::<wbr><a class="mod" href="#">cargo_compile</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../../src/cargo/ops/cargo_compile.rs.html#1-1933">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The Cargo “compile” operation.</p>
<p>This module contains the entry point for starting the compilation process
for commands like <code>build</code>, <code>test</code>, <code>doc</code>, <code>rustc</code>, etc.</p>
<p>The <code>compile</code> function will do all the work to compile a workspace. A
rough outline is:</p>
<ul>
<li>Resolve the dependency graph (see <code>ops::resolve</code>).</li>
<li>Download any packages needed (see <code>PackageSet</code>).</li>
<li>Generate a list of top-level “units” of work for the targets the user
requested on the command-line. Each <code>Unit</code> corresponds to a compiler
invocation. This is done in this module (<code>generate_targets</code>).</li>
<li>Build the graph of <code>Unit</code> dependencies (see
<code>core::compiler::context::unit_dependencies</code>).</li>
<li>Create a <code>Context</code> which will perform the following steps:
<ul>
<li>Prepare the <code>target</code> directory (see <code>Layout</code>).</li>
<li>Create a job queue (see <code>JobQueue</code>). The queue checks the
fingerprint of each <code>Unit</code> to determine if it should run or be
skipped.</li>
<li>Execute the queue. Each leaf in the queue’s dependency graph is
executed, and then removed from the graph when finished. This
repeats until the queue is empty.</li>
</ul>
</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CompileOptions.html" title="cargo::ops::cargo_compile::CompileOptions struct">CompileOptions</a></div><div class="item-right docblock-short"><p>Contains information about how a package should be compiled.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Proposal.html" title="cargo::ops::cargo_compile::Proposal struct">Proposal</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>A proposed target.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.CompileFilter.html" title="cargo::ops::cargo_compile::CompileFilter enum">CompileFilter</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.FilterRule.html" title="cargo::ops::cargo_compile::FilterRule enum">FilterRule</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.LibRule.html" title="cargo::ops::cargo_compile::LibRule enum">LibRule</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Packages.html" title="cargo::ops::cargo_compile::Packages enum">Packages</a></div><div class="item-right docblock-short"></div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.build_glob.html" title="cargo::ops::cargo_compile::build_glob fn">build_glob</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Build <code>glob::Pattern</code> with informative context.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.compile.html" title="cargo::ops::cargo_compile::compile fn">compile</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.compile_with_exec.html" title="cargo::ops::cargo_compile::compile_with_exec fn">compile_with_exec</a></div><div class="item-right docblock-short"><p>Like <code>compile</code> but allows specifying a custom <code>Executor</code> that will be able to intercept build
calls and add custom logic. <code>compile</code> uses <code>DefaultExecutor</code> which just passes calls through.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.compile_ws.html" title="cargo::ops::cargo_compile::compile_ws fn">compile_ws</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.create_bcx.html" title="cargo::ops::cargo_compile::create_bcx fn">create_bcx</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.emit_package_not_found.html" title="cargo::ops::cargo_compile::emit_package_not_found fn">emit_package_not_found</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Emits “package not found” error.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.emit_pattern_not_found.html" title="cargo::ops::cargo_compile::emit_pattern_not_found fn">emit_pattern_not_found</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Emits “glob pattern not found” error.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.filter_default_targets.html" title="cargo::ops::cargo_compile::filter_default_targets fn">filter_default_targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Given a list of all targets for a package, filters out only the targets
that are automatically included when the user doesn’t specify any targets.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.filter_targets.html" title="cargo::ops::cargo_compile::filter_targets fn">filter_targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.find_named_targets.html" title="cargo::ops::cargo_compile::find_named_targets fn">find_named_targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Finds the targets for a specifically named target.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.generate_targets.html" title="cargo::ops::cargo_compile::generate_targets fn">generate_targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Generates all the base targets for the packages the user has requested to
compile. Dependencies for these targets are computed later in <code>unit_dependencies</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.list_rule_targets.html" title="cargo::ops::cargo_compile::list_rule_targets fn">list_rule_targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Returns a list of proposed targets based on command-line target selection flags.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.match_patterns.html" title="cargo::ops::cargo_compile::match_patterns fn">match_patterns</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Checks whether a package matches any of a list of glob patterns generated
from <code>opt_patterns_and_names</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.opt_patterns_and_names.html" title="cargo::ops::cargo_compile::opt_patterns_and_names fn">opt_patterns_and_names</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Given a list opt-in or opt-out package selection strings, generates two
collections that represent glob patterns and package names respectively.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.override_rustc_crate_types.html" title="cargo::ops::cargo_compile::override_rustc_crate_types fn">override_rustc_crate_types</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Override crate types for given units.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.print.html" title="cargo::ops::cargo_compile::print fn">print</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.rebuild_unit_graph_shared.html" title="cargo::ops::cargo_compile::rebuild_unit_graph_shared fn">rebuild_unit_graph_shared</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>This is used to rebuild the unit graph, sharing host dependencies if possible.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.remove_duplicate_doc.html" title="cargo::ops::cargo_compile::remove_duplicate_doc fn">remove_duplicate_doc</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Removes duplicate CompileMode::Doc units that would cause problems with
filename collisions.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.resolve_all_features.html" title="cargo::ops::cargo_compile::resolve_all_features fn">resolve_all_features</a></div><div class="item-right docblock-short"><p>Gets all of the features enabled for a package, plus its dependencies’
features.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.traverse_and_share.html" title="cargo::ops::cargo_compile::traverse_and_share fn">traverse_and_share</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Recursive function for rebuilding the graph.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.unmatched_target_filters.html" title="cargo::ops::cargo_compile::unmatched_target_filters fn">unmatched_target_filters</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Checks if the unit list is empty and the user has passed any combination of
–tests, –examples, –benches or –bins, and we didn’t match on any targets.
We want to emit a warning to make sure the user knows that this run is a no-op,
and their code remains unchecked despite cargo not returning any errors</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.validate_required_features.html" title="cargo::ops::cargo_compile::validate_required_features fn">validate_required_features</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="item-right docblock-short"><p>Warns if a target’s required-features references a feature that doesn’t exist.</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="cargo" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0 (a55dd71d5 2022-09-19)" ></div></body></html>